#!/bin/sh

#  run_all.sh
#
#
#  Created by Lilian Heil on 6/24/20.
#
# Example run all file.


# Tide index, usign FASTA and specifications of your choosing.
crux tide-index --max-mods 1 --mods-spec 1STY+79.966331 --missed-cleavages 0 --overwrite T --min-mods 1 --overwrite T UP000005640_9606.fasta human-index-all

#Perform Tide search, here I used phospho-peptide enriched dataset that can be found on Pride (http://www.ebi.ac.uk/pride/archive) with dataset identifier: PXD029733.

crux tide-search --precursor-window 1.007 --precursor-window-type mz --fileroot "phospho" --top-match 100000 --output-dir results/phospho --concat T --use-tailor-calibration T --overwrite T --num-threads 1 --spectrum-charge 2 data/CM_phospho/201103_S2P1_Lib_400_2.mzML data/CM_phospho/201103_S2P1_Lib_500_2.mzML data/CM_phospho/201103_S2P1_Lib_600_2.mzML data/CM_phospho/201103_S2P1_Lib_700_2.mzML data/CM_phospho/201103_S2P1_Lib_800_2.mzML data/CM_phospho/201103_S2P1_Lib_900_2.mzML data/CM_phospho/human-index-all

# gzip search results to save space

gzip results/phospho/phospho.tide-search.txt

# Generate matrices

python bin/precursor_matrix.py results/phospho/phospho.tide-search.txt --output_dir "results/phospho/matrix" --score "tailor score" --seed 1  --debug --liberal_matching

#Process matrices for each window. Windows may change based on DIA method

bin/process_precursors.r --matrix_dir results/phospho/matrix window_401.txt window_403.txt window_405.txt window_407.txt window_409.txt window_411.txt window_413.txt window_415.txt window_417.txt window_419.txt window_421.txt window_423.txt window_425.txt window_427.txt window_429.txt window_431.txt window_433.txt window_435.txt window_437.txt window_439.txt window_441.txt window_443.txt window_445.txt window_447.txt window_449.txt window_451.txt window_453.txt window_455.txt window_457.txt window_459.txt window_461.txt window_463.txt window_465.txt window_467.txt window_469.txt window_471.txt window_473.txt window_475.txt window_477.txt window_479.txt window_481.txt window_483.txt window_485.txt window_487.txt window_489.txt window_491.txt window_493.txt window_495.txt window_497.txt window_499.txt window_501.txt window_503.txt window_505.txt window_507.txt window_509.txt window_511.txt window_513.txt window_515.txt window_517.txt window_519.txt window_521.txt window_523.txt window_525.txt window_527.txt window_529.txt window_531.txt window_533.txt window_535.txt window_537.txt window_539.txt window_541.txt window_543.txt window_545.txt window_547.txt window_549.txt window_551.txt window_553.txt window_555.txt window_557.txt window_559.txt window_561.txt window_563.txt window_565.txt window_567.txt window_569.txt window_571.txt window_573.txt window_575.txt window_577.txt window_579.txt window_581.txt window_583.txt window_585.txt window_587.txt window_589.txt window_591.txt window_593.txt window_595.txt window_597.txt window_599.txt window_601.txt window_603.txt window_605.txt window_607.txt window_609.txt window_611.txt window_613.txt window_615.txt window_617.txt window_619.txt window_621.txt window_623.txt window_625.txt window_627.txt window_629.txt window_631.txt window_633.txt window_635.txt window_637.txt window_639.txt window_641.txt window_643.txt window_645.txt window_647.txt window_649.txt window_651.txt window_653.txt window_655.txt window_657.txt window_659.txt window_661.txt window_663.txt window_665.txt window_667.txt window_669.txt window_671.txt window_673.txt window_675.txt window_677.txt window_679.txt window_681.txt window_683.txt window_685.txt window_687.txt window_689.txt window_691.txt window_693.txt window_695.txt window_697.txt window_699.txt window_701.txt window_703.txt window_705.txt window_707.txt window_709.txt window_711.txt window_713.txt window_715.txt window_717.txt window_719.txt window_721.txt window_723.txt window_725.txt window_727.txt window_729.txt window_731.txt window_733.txt window_735.txt window_737.txt window_739.txt window_741.txt window_743.txt window_745.txt window_747.txt window_749.txt window_751.txt window_753.txt window_755.txt window_757.txt window_759.txt window_761.txt window_763.txt window_765.txt window_767.txt window_769.txt window_771.txt window_773.txt window_775.txt window_777.txt window_779.txt window_781.txt window_783.txt window_785.txt window_787.txt window_789.txt window_791.txt window_793.txt window_795.txt window_797.txt window_799.txt window_801.txt window_803.txt window_805.txt window_807.txt window_809.txt window_811.txt window_813.txt window_815.txt window_817.txt window_819.txt window_821.txt window_823.txt window_825.txt window_827.txt window_829.txt window_831.txt window_833.txt window_835.txt window_837.txt window_839.txt window_841.txt window_843.txt window_845.txt window_847.txt window_849.txt window_851.txt window_853.txt window_855.txt window_857.txt window_859.txt window_861.txt window_863.txt window_865.txt window_867.txt window_869.txt window_871.txt window_873.txt window_875.txt window_877.txt window_879.txt window_881.txt window_883.txt window_885.txt window_887.txt window_889.txt window_891.txt window_893.txt window_895.txt window_897.txt window_899.txt window_901.txt window_903.txt window_905.txt window_907.txt window_909.txt window_911.txt window_913.txt window_915.txt window_917.txt window_919.txt window_921.txt window_923.txt window_925.txt window_927.txt window_929.txt window_931.txt window_933.txt window_935.txt window_937.txt window_939.txt window_941.txt window_943.txt window_945.txt window_947.txt window_949.txt window_951.txt window_953.txt window_955.txt window_957.txt window_959.txt window_961.txt window_963.txt window_965.txt window_967.txt window_969.txt window_971.txt window_973.txt window_975.txt window_977.txt window_979.txt window_981.txt window_983.txt window_985.txt window_987.txt window_989.txt window_991.txt window_993.txt window_995.txt window_997.txt window_999.txt


#Calculate FDR based on the processed matrices

python bin/precursor_confidence.py --output_file results/phospho/assignconfidence_two_groups_2_charge2.txt --topk 1,2,3,4,5 --seed 1 --plus_one --groups results/phospho/matrix/two_groups_width_2.txt results/phospho/matrix/processed_window_401.txt results/phospho/matrix/processed_window_403.txt results/phospho/matrix/processed_window_405.txt results/phospho/matrix/processed_window_407.txt results/phospho/matrix/processed_window_409.txt results/phospho/matrix/processed_window_411.txt results/phospho/matrix/processed_window_413.txt results/phospho/matrix/processed_window_415.txt results/phospho/matrix/processed_window_417.txt results/phospho/matrix/processed_window_419.txt results/phospho/matrix/processed_window_421.txt results/phospho/matrix/processed_window_423.txt results/phospho/matrix/processed_window_425.txt results/phospho/matrix/processed_window_427.txt results/phospho/matrix/processed_window_429.txt results/phospho/matrix/processed_window_431.txt results/phospho/matrix/processed_window_433.txt results/phospho/matrix/processed_window_435.txt results/phospho/matrix/processed_window_437.txt results/phospho/matrix/processed_window_439.txt results/phospho/matrix/processed_window_441.txt results/phospho/matrix/processed_window_443.txt results/phospho/matrix/processed_window_445.txt results/phospho/matrix/processed_window_447.txt results/phospho/matrix/processed_window_449.txt results/phospho/matrix/processed_window_451.txt results/phospho/matrix/processed_window_453.txt results/phospho/matrix/processed_window_455.txt results/phospho/matrix/processed_window_457.txt results/phospho/matrix/processed_window_459.txt results/phospho/matrix/processed_window_461.txt results/phospho/matrix/processed_window_463.txt results/phospho/matrix/processed_window_465.txt results/phospho/matrix/processed_window_467.txt results/phospho/matrix/processed_window_469.txt results/phospho/matrix/processed_window_471.txt results/phospho/matrix/processed_window_473.txt results/phospho/matrix/processed_window_475.txt results/phospho/matrix/processed_window_477.txt results/phospho/matrix/processed_window_479.txt results/phospho/matrix/processed_window_481.txt results/phospho/matrix/processed_window_483.txt results/phospho/matrix/processed_window_485.txt results/phospho/matrix/processed_window_487.txt results/phospho/matrix/processed_window_489.txt results/phospho/matrix/processed_window_491.txt results/phospho/matrix/processed_window_493.txt results/phospho/matrix/processed_window_495.txt results/phospho/matrix/processed_window_497.txt results/phospho/matrix/processed_window_499.txt results/phospho/matrix/processed_window_501.txt results/phospho/matrix/processed_window_503.txt results/phospho/matrix/processed_window_505.txt results/phospho/matrix/processed_window_507.txt results/phospho/matrix/processed_window_509.txt results/phospho/matrix/processed_window_511.txt results/phospho/matrix/processed_window_513.txt results/phospho/matrix/processed_window_515.txt results/phospho/matrix/processed_window_517.txt results/phospho/matrix/processed_window_519.txt results/phospho/matrix/processed_window_521.txt results/phospho/matrix/processed_window_523.txt results/phospho/matrix/processed_window_525.txt results/phospho/matrix/processed_window_527.txt results/phospho/matrix/processed_window_529.txt results/phospho/matrix/processed_window_531.txt results/phospho/matrix/processed_window_533.txt results/phospho/matrix/processed_window_535.txt results/phospho/matrix/processed_window_537.txt results/phospho/matrix/processed_window_539.txt results/phospho/matrix/processed_window_541.txt results/phospho/matrix/processed_window_543.txt results/phospho/matrix/processed_window_545.txt results/phospho/matrix/processed_window_547.txt results/phospho/matrix/processed_window_549.txt results/phospho/matrix/processed_window_551.txt results/phospho/matrix/processed_window_553.txt results/phospho/matrix/processed_window_555.txt results/phospho/matrix/processed_window_557.txt results/phospho/matrix/processed_window_559.txt results/phospho/matrix/processed_window_561.txt results/phospho/matrix/processed_window_563.txt results/phospho/matrix/processed_window_565.txt results/phospho/matrix/processed_window_567.txt results/phospho/matrix/processed_window_569.txt results/phospho/matrix/processed_window_571.txt results/phospho/matrix/processed_window_573.txt results/phospho/matrix/processed_window_575.txt results/phospho/matrix/processed_window_577.txt results/phospho/matrix/processed_window_579.txt results/phospho/matrix/processed_window_581.txt results/phospho/matrix/processed_window_583.txt results/phospho/matrix/processed_window_585.txt results/phospho/matrix/processed_window_587.txt results/phospho/matrix/processed_window_589.txt results/phospho/matrix/processed_window_591.txt results/phospho/matrix/processed_window_593.txt results/phospho/matrix/processed_window_595.txt results/phospho/matrix/processed_window_597.txt results/phospho/matrix/processed_window_599.txt results/phospho/matrix/processed_window_601.txt results/phospho/matrix/processed_window_603.txt results/phospho/matrix/processed_window_605.txt results/phospho/matrix/processed_window_607.txt results/phospho/matrix/processed_window_609.txt results/phospho/matrix/processed_window_611.txt results/phospho/matrix/processed_window_613.txt results/phospho/matrix/processed_window_615.txt results/phospho/matrix/processed_window_617.txt results/phospho/matrix/processed_window_619.txt results/phospho/matrix/processed_window_621.txt results/phospho/matrix/processed_window_623.txt results/phospho/matrix/processed_window_625.txt results/phospho/matrix/processed_window_627.txt results/phospho/matrix/processed_window_629.txt results/phospho/matrix/processed_window_631.txt results/phospho/matrix/processed_window_633.txt results/phospho/matrix/processed_window_635.txt results/phospho/matrix/processed_window_637.txt results/phospho/matrix/processed_window_639.txt results/phospho/matrix/processed_window_641.txt results/phospho/matrix/processed_window_643.txt results/phospho/matrix/processed_window_645.txt results/phospho/matrix/processed_window_647.txt results/phospho/matrix/processed_window_649.txt results/phospho/matrix/processed_window_651.txt results/phospho/matrix/processed_window_653.txt results/phospho/matrix/processed_window_655.txt results/phospho/matrix/processed_window_657.txt results/phospho/matrix/processed_window_659.txt results/phospho/matrix/processed_window_661.txt results/phospho/matrix/processed_window_663.txt results/phospho/matrix/processed_window_665.txt results/phospho/matrix/processed_window_667.txt results/phospho/matrix/processed_window_669.txt results/phospho/matrix/processed_window_671.txt results/phospho/matrix/processed_window_673.txt results/phospho/matrix/processed_window_675.txt results/phospho/matrix/processed_window_677.txt results/phospho/matrix/processed_window_679.txt results/phospho/matrix/processed_window_681.txt results/phospho/matrix/processed_window_683.txt results/phospho/matrix/processed_window_685.txt results/phospho/matrix/processed_window_687.txt results/phospho/matrix/processed_window_689.txt results/phospho/matrix/processed_window_691.txt results/phospho/matrix/processed_window_693.txt results/phospho/matrix/processed_window_695.txt results/phospho/matrix/processed_window_697.txt results/phospho/matrix/processed_window_699.txt results/phospho/matrix/processed_window_701.txt results/phospho/matrix/processed_window_703.txt results/phospho/matrix/processed_window_705.txt results/phospho/matrix/processed_window_707.txt results/phospho/matrix/processed_window_709.txt results/phospho/matrix/processed_window_711.txt results/phospho/matrix/processed_window_713.txt results/phospho/matrix/processed_window_715.txt results/phospho/matrix/processed_window_717.txt results/phospho/matrix/processed_window_719.txt results/phospho/matrix/processed_window_721.txt results/phospho/matrix/processed_window_723.txt results/phospho/matrix/processed_window_725.txt results/phospho/matrix/processed_window_727.txt results/phospho/matrix/processed_window_729.txt results/phospho/matrix/processed_window_731.txt results/phospho/matrix/processed_window_733.txt results/phospho/matrix/processed_window_735.txt results/phospho/matrix/processed_window_737.txt results/phospho/matrix/processed_window_739.txt results/phospho/matrix/processed_window_741.txt results/phospho/matrix/processed_window_743.txt results/phospho/matrix/processed_window_745.txt results/phospho/matrix/processed_window_747.txt results/phospho/matrix/processed_window_749.txt results/phospho/matrix/processed_window_751.txt results/phospho/matrix/processed_window_753.txt results/phospho/matrix/processed_window_755.txt results/phospho/matrix/processed_window_757.txt results/phospho/matrix/processed_window_759.txt results/phospho/matrix/processed_window_761.txt results/phospho/matrix/processed_window_763.txt results/phospho/matrix/processed_window_765.txt results/phospho/matrix/processed_window_767.txt results/phospho/matrix/processed_window_769.txt results/phospho/matrix/processed_window_771.txt results/phospho/matrix/processed_window_773.txt results/phospho/matrix/processed_window_775.txt results/phospho/matrix/processed_window_777.txt results/phospho/matrix/processed_window_779.txt results/phospho/matrix/processed_window_781.txt results/phospho/matrix/processed_window_783.txt results/phospho/matrix/processed_window_785.txt results/phospho/matrix/processed_window_787.txt results/phospho/matrix/processed_window_789.txt results/phospho/matrix/processed_window_791.txt results/phospho/matrix/processed_window_793.txt results/phospho/matrix/processed_window_795.txt results/phospho/matrix/processed_window_797.txt results/phospho/matrix/processed_window_799.txt results/phospho/matrix/processed_window_801.txt results/phospho/matrix/processed_window_803.txt results/phospho/matrix/processed_window_805.txt results/phospho/matrix/processed_window_807.txt results/phospho/matrix/processed_window_809.txt results/phospho/matrix/processed_window_811.txt results/phospho/matrix/processed_window_813.txt results/phospho/matrix/processed_window_815.txt results/phospho/matrix/processed_window_817.txt results/phospho/matrix/processed_window_819.txt results/phospho/matrix/processed_window_821.txt results/phospho/matrix/processed_window_823.txt results/phospho/matrix/processed_window_825.txt results/phospho/matrix/processed_window_827.txt results/phospho/matrix/processed_window_829.txt results/phospho/matrix/processed_window_831.txt results/phospho/matrix/processed_window_833.txt results/phospho/matrix/processed_window_835.txt results/phospho/matrix/processed_window_837.txt results/phospho/matrix/processed_window_839.txt results/phospho/matrix/processed_window_841.txt results/phospho/matrix/processed_window_843.txt results/phospho/matrix/processed_window_845.txt results/phospho/matrix/processed_window_847.txt results/phospho/matrix/processed_window_849.txt results/phospho/matrix/processed_window_851.txt results/phospho/matrix/processed_window_853.txt results/phospho/matrix/processed_window_855.txt results/phospho/matrix/processed_window_857.txt results/phospho/matrix/processed_window_859.txt results/phospho/matrix/processed_window_861.txt results/phospho/matrix/processed_window_863.txt results/phospho/matrix/processed_window_865.txt results/phospho/matrix/processed_window_867.txt results/phospho/matrix/processed_window_869.txt results/phospho/matrix/processed_window_871.txt results/phospho/matrix/processed_window_873.txt results/phospho/matrix/processed_window_875.txt results/phospho/matrix/processed_window_877.txt results/phospho/matrix/processed_window_879.txt results/phospho/matrix/processed_window_881.txt results/phospho/matrix/processed_window_883.txt results/phospho/matrix/processed_window_885.txt results/phospho/matrix/processed_window_887.txt results/phospho/matrix/processed_window_889.txt results/phospho/matrix/processed_window_891.txt results/phospho/matrix/processed_window_893.txt results/phospho/matrix/processed_window_895.txt results/phospho/matrix/processed_window_897.txt results/phospho/matrix/processed_window_899.txt results/phospho/matrix/processed_window_901.txt results/phospho/matrix/processed_window_903.txt results/phospho/matrix/processed_window_905.txt results/phospho/matrix/processed_window_907.txt results/phospho/matrix/processed_window_909.txt results/phospho/matrix/processed_window_911.txt results/phospho/matrix/processed_window_913.txt results/phospho/matrix/processed_window_915.txt results/phospho/matrix/processed_window_917.txt results/phospho/matrix/processed_window_919.txt results/phospho/matrix/processed_window_921.txt results/phospho/matrix/processed_window_923.txt results/phospho/matrix/processed_window_925.txt results/phospho/matrix/processed_window_927.txt results/phospho/matrix/processed_window_929.txt results/phospho/matrix/processed_window_931.txt results/phospho/matrix/processed_window_933.txt results/phospho/matrix/processed_window_935.txt results/phospho/matrix/processed_window_937.txt results/phospho/matrix/processed_window_939.txt results/phospho/matrix/processed_window_941.txt results/phospho/matrix/processed_window_943.txt results/phospho/matrix/processed_window_945.txt results/phospho/matrix/processed_window_947.txt results/phospho/matrix/processed_window_949.txt results/phospho/matrix/processed_window_951.txt results/phospho/matrix/processed_window_953.txt results/phospho/matrix/processed_window_955.txt results/phospho/matrix/processed_window_957.txt results/phospho/matrix/processed_window_959.txt results/phospho/matrix/processed_window_961.txt results/phospho/matrix/processed_window_963.txt results/phospho/matrix/processed_window_965.txt results/phospho/matrix/processed_window_967.txt results/phospho/matrix/processed_window_969.txt results/phospho/matrix/processed_window_971.txt results/phospho/matrix/processed_window_973.txt results/phospho/matrix/processed_window_975.txt results/phospho/matrix/processed_window_977.txt results/phospho/matrix/processed_window_979.txt results/phospho/matrix/processed_window_981.txt results/phospho/matrix/processed_window_983.txt results/phospho/matrix/processed_window_985.txt results/phospho/matrix/processed_window_987.txt results/phospho/matrix/processed_window_989.txt results/phospho/matrix/processed_window_991.txt results/phospho/matrix/processed_window_993.txt results/phospho/matrix/processed_window_995.txt results/phospho/matrix/processed_window_997.txt results/phospho/matrix/processed_window_999.txt
